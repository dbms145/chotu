CREATE TABLE students (
student_id INT PRIMARY KEY,
name VARCHAR(100),
fees DECIMAL(10,2)
);

DELIMITER $$
CREATE TRIGGER before_student_insert
BEFORE INSERT ON students
FOR EACH ROW
BEGIN
-- If the new fee is less than 10,000, set it to 10,000
IF NEW.fees < 10000 THEN
SET NEW.fees = 10000;
END IF;
END $$
DELIMITER ;

INSERT INTO students (student_id, name, fees) VALUES (5, 'Rahul', 8000);
SELECT * FROM students WHERE student_id = 5;

CREATE TABLE fee_changes (
change_id INT AUTO_INCREMENT PRIMARY KEY,
student_id INT,
old_fees DECIMAL(10,2),
new_fees DECIMAL(10,2),
change_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

DELIMITER $$
CREATE TRIGGER after_fees_update
AFTER UPDATE ON students
FOR EACH ROW
BEGIN
-- Insert the old and new fees into the log table
INSERT INTO fee_changes (student_id, old_fees, new_fees)
VALUES (OLD.student_id, OLD.fees, NEW.fees);
END $$

INSERT INTO students (student_id, name, fees) VALUES
-> (1, 'Rahul', 20000.00),
-> (2, 'Priya', 25000.00);

UPDATE students SET fees = 26000 WHERE student_id = 1;
SELECT * FROM fee_changes;
