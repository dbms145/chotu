#include <GL/glut.h>
#include <cmath>  

int frameNumber = 0;

// Function to draw a windmill
void drawWindmill() {
    // Draw the base (yellow)
    glColor3f(1.0f, 1.0f, 0.0f);  // Yellow color
    glBegin(GL_POLYGON);
        glVertex2f(-0.05f, 0.0f);
        glVertex2f(-0.05f, 3.0f);
        glVertex2f( 0.05f, 3.0f);
        glVertex2f( 0.05f, 0.0f);
    glEnd();

    // Move origin to top of the base
    glTranslatef(0.0f, 3.0f, 0.0f);

    // Rotate the blades
    glRotated(frameNumber * 4.0, 0.0, 0.0, 1.0);  // Rotate around Z-axis

    // Draw 4 blades (red)
    glColor3f(1.0f, 0.0f, 0.0f);  // Red color
    for (int i = 0; i < 6; i++) {
        glRotated(90, 0.0, 0.0, 1.0);  // Rotate each blade 90 degrees
        glBegin(GL_POLYGON);
            glVertex2f(0.0f,  0.0f);
            glVertex2f(1.0f,  0.2f);
            glVertex2f(1.0f, -0.2f);
        glEnd();
    }
}

// Display function - draws everything
void display() {
    glClear(GL_COLOR_BUFFER_BIT);
    glLoadIdentity();

    // First windmill
    glPushMatrix();
    glTranslatef(2.2f, 1.6f, 0.0f);
    glScalef(0.4f, 0.4f, 1.0f);
    drawWindmill();
    glPopMatrix();

    // Second windmill
    glPushMatrix();
    glTranslatef(3.7f, 0.8f, 0.0f);
    glScalef(0.7f, 0.7f, 1.0f);
    drawWindmill();
    glPopMatrix();

    glutSwapBuffers();
}

// Called every few milliseconds to update the frame
    void doFrame(int v) {
    frameNumber++;                      // Increase frame count
    glutPostRedisplay();                // Redraw the screen
    glutTimerFunc(10, doFrame, 0);      // Call again after 10 ms
}

// Initialization function
    void init() {
    glClearColor(0.0f, 0.0f, 0.0f, 0.0f);  // Black background

    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    glOrtho(0.0, 7.0, -1.0, 4.0, -1.0, 1.0);  // Set coordinate range
    glMatrixMode(GL_MODELVIEW);
}

// Main function
int main(int argc, char** argv) {
    glutInit(&argc, argv);
    glutInitDisplayMode(GLUT_DOUBLE);
    glutInitWindowSize(700, 500);             // Window size
    glutInitWindowPosition(100, 100);         // Window position
    glutCreateWindow("Windmill Animation");   // Window title

    init();                                   // Initialize OpenGL
    glutDisplayFunc(display);                 // Set display function
    glutTimerFunc(200, doFrame, 0);           // Start animation
    glutMainLoop();                           // Start event loop

    return 0;
}
